# 💾 coin_results.xlsx 저장 기능 가이드

## 개요
`coin_results.xlsx` 저장 버튼은 크롤링한 코인 데이터를 **고정된 파일명**으로 **전문적인 스타일**과 함께 즉시 저장하는 기능입니다.

## 특징

### 🎨 전문적인 스타일링
openpyxl 라이브러리를 사용하여 다음과 같은 스타일이 자동으로 적용됩니다:

1. **헤더 스타일**
   - 파란색 배경 (#3498DB)
   - 흰색 굵은 글씨
   - 가운데 정렬
   - 테두리 적용

2. **데이터 스타일**
   - 코인명: 굵은 글씨
   - 순위: 가운데 정렬
   - 가격 정보: 오른쪽 정렬
   - 모든 셀에 테두리 적용

3. **김프율 색상 코딩**
   - 양수 (프리미엄): 녹색 (#27AE60)
   - 음수 (디스카운트): 빨간색 (#E74C3C)
   - 굵은 글씨로 강조

4. **최적화된 레이아웃**
   - 각 열에 최적화된 너비 자동 설정
   - 헤더 행 높이 증가 (25)
   - 가독성 높은 간격

## 사용 방법

### 1. 크롤링 완료 후
```
1. 크롤링이 완료되면 데이터가 테이블에 표시됩니다
2. "💾 coin_results.xlsx로 저장" 버튼 클릭
3. 자동으로 현재 디렉토리에 coin_results.xlsx 파일 생성
4. 성공 메시지 확인
```

### 2. 파일 위치
- 파일은 **프로그램 실행 디렉토리**에 저장됩니다
- 파일명: `coin_results.xlsx` (고정)
- 기존 파일이 있으면 **덮어쓰기**됩니다

## Excel 파일 구조

### 시트 이름
- `김프가 코인 데이터`

### 열 구성
| 열 | 내용 | 너비 | 정렬 | 스타일 |
|----|------|------|------|--------|
| A | 순위 | 8 | 가운데 | 테두리 |
| B | 코인명 | 20 | 왼쪽 | 굵게, 테두리 |
| C | 심볼 | 12 | 왼쪽 | 테두리 |
| D | 국내가격 | 18 | 오른쪽 | 테두리 |
| E | 해외가격 | 18 | 오른쪽 | 테두리 |
| F | 김프율 | 12 | 가운데 | 색상 코딩, 굵게, 테두리 |
| G | 김프액 | 18 | 오른쪽 | 테두리 |
| H | 수집시간 | 20 | 가운데 | 테두리 |

## 예시 출력

```
┌──────────────────────────────────────────────────────────────────┐
│  순위 │   코인명   │ 심볼 │  국내가격  │  해외가격  │ 김프율 │ ... │
├──────────────────────────────────────────────────────────────────┤
│   1   │ Bitcoin    │ BTC  │ 50,000,000 │ 49,500,000 │ +1.01% │ ... │
│   2   │ Ethereum   │ ETH  │  3,200,000 │  3,250,000 │ -1.54% │ ... │
│   3   │ Ripple     │ XRP  │      1,200 │      1,180 │ +1.69% │ ... │
└──────────────────────────────────────────────────────────────────┘
```

## 다른 저장 방법과의 비교

| 기능 | CSV 저장 | Excel 저장 | coin_results.xlsx |
|------|----------|------------|-------------------|
| 파일명 선택 | ✅ | ✅ | ❌ (고정) |
| 날짜/시간 포함 | ✅ | ✅ | ❌ |
| 스타일링 | ❌ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 색상 코딩 | ❌ | ❌ | ✅ |
| 즉시 저장 | ❌ | ❌ | ✅ |
| 덮어쓰기 | 확인 필요 | 확인 필요 | 자동 |

## 장점

### ✅ 빠른 저장
- 파일명 선택 대화상자 없음
- 클릭 한 번으로 즉시 저장
- 반복 작업에 최적화

### ✅ 일관된 파일명
- 항상 같은 이름으로 저장
- 스크립트나 다른 프로그램에서 쉽게 참조 가능
- 자동화에 유리

### ✅ 전문적인 외관
- 보고서나 발표 자료로 바로 사용 가능
- 색상으로 중요 정보 강조
- 깔끔한 레이아웃

## 활용 예시

### 1. 정기 모니터링
```
매일 같은 시간에 크롤링 → coin_results.xlsx 저장
→ 항상 최신 데이터로 업데이트
```

### 2. 자동화 워크플로우
```python
# 다른 스크립트에서 결과 파일 읽기
import pandas as pd

df = pd.read_excel('coin_results.xlsx')
# 데이터 분석 또는 처리
```

### 3. 빠른 확인
```
크롤링 → 저장 → Excel에서 바로 열기
→ 색상으로 김프율 한눈에 확인
```

## 문제 해결

### openpyxl 오류
```bash
# openpyxl이 설치되어 있지 않은 경우
pip install openpyxl
```

### 파일이 열려 있음
- Excel에서 coin_results.xlsx 파일을 닫고 다시 시도
- 파일이 다른 프로그램에서 사용 중이면 저장 실패

### 권한 오류
- 프로그램을 관리자 권한으로 실행
- 쓰기 권한이 있는 디렉토리에서 실행

## 코드 예시

저장 버튼의 핵심 코드:

```python
def save_to_coin_results(self):
    """coin_results.xlsx 파일로 저장 (openpyxl 사용)"""
    filename = 'coin_results.xlsx'
    
    # openpyxl로 워크북 생성
    wb = Workbook()
    ws = wb.active
    
    # 헤더 스타일 적용
    header_font = Font(bold=True, color="FFFFFF", size=12)
    header_fill = PatternFill(start_color="3498DB", 
                              end_color="3498DB", 
                              fill_type="solid")
    
    # 데이터 작성 및 스타일 적용
    # ... (김프율에 따라 색상 변경)
    
    # 파일 저장
    wb.save(filename)
```

---

**팁**: 이 기능은 매일 같은 시간에 데이터를 수집하고 항상 같은 파일에 저장하고 싶을 때 매우 유용합니다!
