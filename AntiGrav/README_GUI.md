# 김프가 코인 크롤러 - GUI 버전 사용 가이드

## 📋 개요
김프가(kimpga.com)에서 암호화폐 데이터를 크롤링하는 PyQt5 기반 GUI 애플리케이션입니다.

## ✨ 주요 기능

### 1. 사용자 친화적인 GUI
- 직관적인 인터페이스로 쉬운 조작
- 실시간 진행 상황 표시
- 색상으로 구분된 김프율 표시 (양수: 녹색, 음수: 빨간색)

### 2. 크롤링 기능
- 상위 1~100개 코인 선택 가능
- 백그라운드 모드 지원 (브라우저 숨김)
- 실시간 진행 상황 모니터링
- 중지 기능 지원

### 3. 데이터 표시
- 테이블 형식으로 깔끔한 데이터 표시
- 다음 정보 포함:
  - 순위
  - 코인명
  - 심볼
  - 국내가격
  - 해외가격
  - 김프율
  - 김프액
  - 수집시간

### 4. 데이터 내보내기
- **CSV 파일로 저장**: 파일명 선택 가능
- **Excel 파일로 저장**: 파일명 선택 가능 (자동 열 너비 조정)
- **💾 coin_results.xlsx로 저장**: 고정된 파일명으로 즉시 저장
  - openpyxl을 사용한 전문적인 스타일링
  - 헤더에 파란색 배경과 흰색 글씨
  - 김프율에 따른 자동 색상 적용 (양수: 녹색, 음수: 빨간색)
  - 테두리와 정렬 자동 적용
  - 최적화된 열 너비
- 파일명에 자동으로 날짜/시간 포함 (CSV/Excel)

## 🚀 설치 방법

### 1. 필요한 패키지 설치
```bash
pip install -r requirements.txt
```

### 2. Chrome 브라우저 설치
- Chrome 브라우저가 설치되어 있어야 합니다
- ChromeDriver는 자동으로 설치됩니다 (webdriver-manager 사용)

## 💻 사용 방법

### 1. 프로그램 실행
```bash
python kimpga_scraper_gui.py
```

### 2. 설정
1. **크롤링할 코인 개수**: 1~100 사이의 숫자 입력 (기본값: 20)
2. **백그라운드 모드**: 
   - 체크: 브라우저 창이 보이지 않음 (빠름)
   - 해제: 브라우저 창이 보임 (디버깅용)

### 3. 크롤링 시작
1. **🚀 크롤링 시작** 버튼 클릭
2. 진행 상황 창에서 실시간 진행 상황 확인
3. 완료되면 테이블에 데이터가 표시됨

### 4. 데이터 저장
- **📄 CSV로 저장**: CSV 형식으로 저장 (파일명 선택)
- **📊 Excel로 저장**: Excel 형식으로 저장 (파일명 선택, 스타일 적용)
- **💾 coin_results.xlsx로 저장**: 고정된 파일명으로 즉시 저장 (전문적인 스타일링)

### 5. 중지
- **⏹ 중지** 버튼으로 언제든지 크롤링 중지 가능

## 📊 화면 구성

```
┌─────────────────────────────────────────────────────┐
│        🪙 김프가 코인 크롤러                          │
├─────────────────────────────────────────────────────┤
│ [설정]                                               │
│ 크롤링할 코인 개수: [20] ☑ 백그라운드 모드           │
│                      [🚀 크롤링 시작] [⏹ 중지]       │
├─────────────────────────────────────────────────────┤
│ [진행 상황]                                          │
│ ┌─────────────────────────────────────────────────┐ │
│ │ [WEB] https://kimpga.com/ 접속 중...            │ │
│ │ [WAIT] 페이지 로딩 대기 중...                   │ │
│ │ 1. Bitcoin (BTC) - 김프율: 0.5%                 │ │
│ └─────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────┤
│ [수집된 데이터]                                      │
│ ┌─────────────────────────────────────────────────┐ │
│ │순위│코인명│심볼│국내가격│해외가격│김프율│김프액│ │ │
│ ├───┼─────┼───┼───────┼───────┼─────┼─────┤ │
│ │ 1 │Bitcoin│BTC│...    │...    │0.5% │...  │ │ │
│ └─────────────────────────────────────────────────┘ │
│         [📄 CSV로 저장] [📊 Excel로 저장] [💾 coin_results.xlsx로 저장]│
└─────────────────────────────────────────────────────┘
```

## 🎨 UI 특징

### 색상 코드
- **녹색 버튼**: 시작/Excel 저장 기능
- **빨간색 버튼**: 중지 기능
- **파란색 버튼**: CSV 저장
- **보라색 버튼**: coin_results.xlsx 저장 (고정 파일명)
- **김프율 색상**:
  - 🟢 녹색: 양수 (프리미엄)
  - 🔴 빨간색: 음수 (디스카운트)

### 스타일
- 모던한 Fusion 스타일 적용
- 가독성 높은 테이블 디자인
- 콘솔 스타일의 진행 상황 표시

## ⚙️ 기술 스택

- **GUI Framework**: PyQt5
- **웹 크롤링**: Selenium + BeautifulSoup4
- **데이터 처리**: Pandas
- **브라우저**: Chrome (자동 드라이버 관리)

## 🔧 문제 해결

### PyQt5 설치 오류
```bash
# Windows
pip install PyQt5

# macOS (Apple Silicon)
pip install PyQt5 --no-binary PyQt5
```

### Chrome 드라이버 오류
- Chrome 브라우저가 최신 버전인지 확인
- 인터넷 연결 확인 (드라이버 자동 다운로드)

### 데이터가 수집되지 않을 때
1. 백그라운드 모드 해제하고 브라우저 동작 확인
2. 웹사이트 접근 가능 여부 확인
3. 인터넷 연결 확인

## 📝 명령줄 버전과의 차이점

| 기능 | GUI 버전 | 명령줄 버전 |
|------|---------|------------|
| 사용 편의성 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
| 실시간 모니터링 | ✅ | ❌ |
| 중지 기능 | ✅ | ❌ |
| 데이터 시각화 | ✅ | ❌ |
| 자동화 | ❌ | ✅ |

## 📄 라이선스
MIT License

## 👨‍💻 개발자
Kimpga Scraper GUI v2.0

---

**참고**: 이 프로그램은 교육 목적으로 제작되었습니다. 웹사이트의 이용 약관을 준수하여 사용하시기 바랍니다.
